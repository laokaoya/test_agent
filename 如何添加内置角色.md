# 📖 如何添加内置角色

## 🎯 概述

所有内置角色的配置都存储在 `preset_children.json` 文件中。要添加新的内置角色，只需编辑这个文件即可，无需修改代码。

**✨ 重要：** 角色的 `traits` 字段现在使用 **统一的 Markdown 格式**，便于阅读、维护和扩展。

## 📝 添加新角色的步骤

### 1. 打开配置文件

编辑项目根目录下的 `preset_children.json` 文件。

### 2. 使用标准模板

复制以下模板，填入您的角色信息：

```json
{
  "角色ID": {
    "id": "角色ID",
    "name": "角色名称",
    "age": 年龄,
    "emoji": "👦",
    "type": "类型描述",
    "description": "测试目标说明",
    "traits": "## 角色性格\n- 性格特点1\n- 性格特点2\n- 性格特点3\n\n## 行为反应\n**正面反应：**\n- 如果 AI ... → 你会...\n\n**负面反应：**\n- 如果 AI ... → 你会...\n\n## 英语水平\n- 水平描述1\n- 水平描述2\n\n## 回答特点\n- 回答特点1\n- 回答特点2",
    "opening": "开场白"
  }
}
```

### 3. 完整示例

```json
{
  "xiaoxin": {
    "id": "xiaoxin",
    "name": "小新",
    "age": 6,
    "emoji": "🧒",
    "type": "活泼型",
    "description": "测试AI是否能保持高能量互动",
    "traits": "## 角色性格\n- 非常活泼好动\n- 说话很快\n- 喜欢讲笑话和玩游戏\n\n## 行为反应\n**正面反应：**\n- 如果 AI 能跟上你的节奏 → 你会更开心\n- 如果 AI 玩游戏 → 你会很兴奋\n\n**负面反应：**\n- 如果 AI 太慢 → 你会觉得无聊\n- 如果 AI 太严肃 → 你会失去兴趣\n\n## 英语水平\n- 能说流利的句子\n- 词汇量中等\n\n## 回答特点\n- 语速快\n- 经常使用感叹句\n- 喜欢用夸张的表达",
    "opening": "Hey! Let's play something fun!"
  }
}
```

## 🔍 字段说明

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| `id` | String | ✅ | 角色的唯一标识符（建议使用英文） |
| `name` | String | ✅ | 角色的显示名称 |
| `age` | Number | ✅ | 角色年龄（用于测试场景） |
| `emoji` | String | ✅ | 菜单中显示的表情符号 |
| `type` | String | ✅ | 角色类型（显示在菜单中） |
| `description` | String | ⭕ | 测试目标的简短说明 |
| `traits` | String | ✅ | 详细的性格描述和Prompt（**最重要**） |
| `opening` | String | ✅ | 对话开场白 |

## 📐 Markdown 格式规范

### traits 字段结构（必须遵循）

`traits` 字段使用标准的 Markdown 格式，包含 **四个必需部分**：

#### 1️⃣ 角色性格
```markdown
## 角色性格
- 性格特点1
- 性格特点2
- 性格特点3
```

#### 2️⃣ 行为反应
```markdown
## 行为反应
**正面反应：**
- 如果 AI 做某事 → 你会如何反应

**负面反应：**
- 如果 AI 做某事 → 你会如何反应
```

#### 3️⃣ 英语水平
```markdown
## 英语水平
- 水平描述1
- 水平描述2
```

#### 4️⃣ 回答特点
```markdown
## 回答特点
- 特点1
- 特点2
- 特点3
```

### 格式要点

- 使用 `\n` 表示换行
- 使用 `##` 作为二级标题
- 使用 `-` 开头的无序列表
- 使用 `**粗体**` 强调关键词
- 使用 `→` 表示因果关系

## ⚠️ 注意事项

1. **JSON格式**：确保JSON格式正确，注意逗号和引号
2. **唯一ID**：每个角色的ID必须唯一
3. **Markdown格式**：traits字段必须严格遵循上述四部分结构
4. **换行符**：在JSON中使用 `\n` 表示换行
5. **逗号问题**：JSON对象中最后一项后面**不要**加逗号

## 🔄 应用更改

添加或修改角色后：

1. **无需重启应用**（下次刷新页面时自动加载）
2. 或者手动刷新浏览器页面（F5 或 Ctrl+F5）
3. 新角色会自动出现在"快速添加内置角色"下拉菜单中

## ✅ 验证配置

可以使用在线JSON验证工具检查格式：
- https://jsonlint.com/
- 或者使用VSCode的JSON格式化功能

## 💡 最佳实践

### traits 字段编写建议：

#### ✅ 推荐做法

1. **清晰的结构**：严格遵循四部分格式
2. **具体的触发条件**：用 "如果...→你会..." 格式
3. **可测试的特征**：行为特点要具体，方便Gemini模拟
4. **适当的细节**：不要太简略，也不要过于冗长

#### ❌ 避免的做法

1. 不要省略四个必需部分
2. 不要使用不一致的格式
3. 不要写过于抽象的描述
4. 不要忘记 `\n` 换行符

## 🎯 常见角色类型参考

1. **害羞型**：测试引导能力
2. **话多型**：测试倾听和引导能力
3. **好奇型**：测试知识延伸能力
4. **自信型**：测试平等互动能力
5. **抗拒型**：测试激发兴趣能力
6. **分心型**：测试注意力管理能力
7. **完美型**：测试鼓励和纠错平衡

---

**文件位置**：`d:\test_agent\preset_children.json`  
**最后更新**：2025-10-18

