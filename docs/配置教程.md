# 🚀 AI儿童英语陪伴产品评测系统 - 配置教程

> **快速配置指南** - 让您快速上手评测系统

---

## 📋 系统要求

- **Python版本：** 3.8 或更高版本
- **操作系统：** Windows 10/11, macOS, Linux
- **内存：** 建议 4GB 以上
- **网络：** 需要访问 Gemini API 和 Dify API

---

## 🔧 安装步骤

### 1. 克隆项目

```{bash}
git clone <项目地址>
cd test_agent
```

### 2. 安装Python依赖

```{{bash}}
# 安装Flask和相关依赖
pip install flask

# 安装Gemini AI SDK
pip install google-generativeai

# 安装其他依赖
pip install requests
```

### 3. 配置API密钥

#### 获取Gemini API密钥
1. 访问 [Google AI Studio](https://makersuite.google.com/app/apikey)
2. 创建新的API密钥
3. 复制API密钥

#### 获取Dify API密钥
1. 访问您的Dify工作台
2. 进入应用设置
3. 复制API密钥

#### 配置API密钥
在项目根目录创建 `.env` 文件：

```env
# Gemini API配置
GEMINI_API_KEY=your_gemini_api_key_here

# Dify API配置  
DIFY_API_KEY=your_dify_api_key_here
DIFY_BASE_URL=https://api.dify.ai/v1
```

---

## 🚀 启动系统

### 方法1：直接启动

```{{bash}}
# 进入项目目录
cd test_agent

# 启动Flask应用
python app.py
```

### 方法2：后台运行

```{{bash}}
# Windows
start python app.py

# macOS/Linux
nohup python app.py &
```

### 启动成功标志

看到以下输出表示启动成功：
```
* Serving Flask app 'app'
* Debug mode: off
* Running on http://127.0.0.1:5000
* Running on http://10.0.0.99:5000
```

---

## 🌐 访问系统

### 打开浏览器访问

```
http://localhost:5000
```

### 系统功能

- **主页面：** 配置测试角色和评测标准
- **测试页面：** 运行AI对话测试
- **结果页面：** 查看评测结果和分析
- **仪表板：** 查看历史数据和统计

---

## ⚙️ 配置说明

### 测试角色配置

系统预设了5种典型儿童角色：
- 🐻 小熊（害羞型）
- 👧 Yoyo（话多型）  
- 🧒 乐乐（好奇型）
- 👸 Emma（自信型）
- 🙅 豆豆（抗拒型）

**支持自定义角色：**
- 点击"添加自定义角色"按钮
- 填写角色信息（姓名、年龄、性格、开场白）
- 保存后即可使用

### 评测标准配置

系统预设了3个一级指标，15个二级指标：
- **英语表达能力与思维拓展**（5个指标）
- **英语表达意愿与参与感**（5个指标）
- **智能自适应能力**（5个指标）

**支持自定义标准：**
- 点击"添加评分标准"按钮
- 填写标准名称和描述
- 设置权重和评分要求

---

## 🔍 常见问题

### Q1: 启动失败怎么办？

**检查Python版本：**
```{bash}
python --version
# 确保是3.8或更高版本
```

**检查依赖安装：**
```{bash}
pip list | grep flask
pip list | grep google-generativeai
```

### Q2: API调用失败？

**检查API密钥：**
- 确认Gemini API密钥有效
- 确认Dify API密钥有效
- 检查网络连接

**检查API配额：**
- Gemini API有免费额度限制
- Dify API需要有效订阅

### Q3: 端口被占用？

**更换端口：**
```python
# 在app.py中修改端口
app.run(host='0.0.0.0', port=5001)  # 改为5001端口
```

**或者关闭占用端口的进程：**
```{bash}
# Windows
netstat -ano | findstr :5000
taskkill /PID <进程ID> /F

# macOS/Linux
lsof -ti:5000 | xargs kill -9
```

### Q4: 如何添加新的测试角色？

1. 在系统界面点击"添加自定义角色"
2. 填写角色信息：
   - 姓名：角色名称
   - 年龄：建议4-10岁
   - 性格：详细描述性格特点
   - 开场白：第一句话
3. 点击"保存"按钮

### Q5: 如何添加新的评测标准？

1. 在系统界面点击"添加评分标准"
2. 填写标准信息：
   - 标准名称：简洁明确的名称
   - 描述：详细的评分说明
   - 权重：影响综合评分的权重
3. 点击"保存"按钮

---

## 📊 使用流程

### 1. 配置测试
- 选择测试角色（可多选）
- 选择评测标准（可多选）
- 设置对话轮数（默认3轮）

### 2. 运行测试
- 点击"开始测试"按钮
- 系统自动运行AI对话
- 实时显示测试进度

### 3. 查看结果
- 查看详细评分
- 分析问题点
- 导出测试报告

### 4. 数据分析
- 访问仪表板查看统计
- 对比不同角色表现
- 识别改进方向

---

## 🛠️ 高级配置

### 修改默认配置

编辑 `config/preset_criteria.json` 文件：
```json
{
  "标准ID": {
    "name": "标准名称",
    "weight": 1.0,
    "prompt": "评分提示"
  }
}
```

### 自定义评分权重

在配置文件中调整权重：
```json
{
  "weight": 1.5  // 权重越高，影响越大
}
```

### 修改通过标准

在 `app.py` 中调整通过标准：
```python
# 修改最低分数要求
MIN_SCORE = 7.0  # 默认7.0分
MIN_ITEM_SCORE = 5.0  # 单项最低分
```

---

## 📞 技术支持

### 获取帮助

- **详细文档：** `AI儿童英语陪伴产品评测体系.md`
- **快速参考：** `内测通过标准_快速参考卡.md`
- **数据说明：** `数据存储说明.md`

### 常见错误

| 错误信息 | 解决方案 |
|----------|----------|
| `ModuleNotFoundError: No module named 'flask'` | 运行 `pip install flask` |
| `API key not found` | 检查 `.env` 文件中的API密钥 |
| `Port 5000 is already in use` | 更换端口或关闭占用进程 |
| `Connection timeout` | 检查网络连接和API服务状态 |

---

## 🎯 快速开始

### 5分钟快速体验

1. **安装依赖**
   ```{bash}
   pip install flask google-generativeai requests
   ```

2. **配置API密钥**
   ```{bash}
   # 创建.env文件，添加API密钥
   echo "GEMINI_API_KEY=your_key_here" > .env
   echo "DIFY_API_KEY=your_key_here" >> .env
   ```

3. **启动系统**
   ```{bash}
   python app.py
   ```

4. **开始测试**
   - 打开 http://localhost:5000
   - 选择默认角色和标准
   - 点击"开始测试"

---

**配置完成！开始您的AI评测之旅吧！🎉**
